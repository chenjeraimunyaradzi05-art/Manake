{"version":3,"names":["_zustand","require","_api","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty2","default","getOwnPropertyDescriptors","defineProperties","defineProperty","useAuthStore","exports","create","set","get","user","token","isAuthenticated","isLoading","error","login","_login","_asyncToGenerator2","credentials","response","authApi","success","setAuthToken","data","Error","message","_x","register","_register","_x2","socialLogin","_socialLogin","provider","payload","socialLoginGoogle","socialLoginApple","_x3","_x4","logout","_logout","_unused","loadUser","_loadUser","_get","getProfile","_unused2","updateProfile","_updateProfile","_get2","_data$preferences","_data$stats","preferences","stats","_get3","_data$preferences2","_data$stats2","_x5","clearError","setDemoMode","mockData","_default"],"sources":["authStore.ts"],"sourcesContent":["import { create } from 'zustand';\nimport type { User, AuthState, LoginCredentials, RegisterData } from '../types';\nimport { authApi, setAuthToken, mockData } from '../services/api';\n\ninterface AuthStore extends AuthState {\n  // Actions\n  login: (credentials: LoginCredentials) => Promise<void>;\n  register: (data: RegisterData) => Promise<void>;\n  socialLogin: (provider: 'google' | 'apple', payload: Record<string, unknown>) => Promise<void>;\n  logout: () => Promise<void>;\n  loadUser: () => Promise<void>;\n  updateProfile: (data: Partial<User>) => Promise<void>;\n  clearError: () => void;\n  setDemoMode: () => void;\n}\n\nexport const useAuthStore = create<AuthStore>((set, get) => ({\n  // Initial state\n  user: null,\n  token: null,\n  isAuthenticated: false,\n  isLoading: false,\n  error: null,\n\n  // Actions\n  login: async (credentials: LoginCredentials) => {\n    set({ isLoading: true, error: null });\n    try {\n      const response = await authApi.login(credentials);\n      if (response.success) {\n        setAuthToken(response.data.token);\n        set({\n          user: response.data.user,\n          token: response.data.token,\n          isAuthenticated: true,\n          isLoading: false,\n        });\n      } else {\n        throw new Error(response.message || 'Login failed');\n      }\n    } catch (error) {\n      set({\n        error: error instanceof Error ? error.message : 'Login failed',\n        isLoading: false,\n      });\n      throw error;\n    }\n  },\n\n  register: async (data: RegisterData) => {\n    set({ isLoading: true, error: null });\n    try {\n      const response = await authApi.register(data);\n      if (response.success) {\n        setAuthToken(response.data.token);\n        set({\n          user: response.data.user,\n          token: response.data.token,\n          isAuthenticated: true,\n          isLoading: false,\n        });\n      } else {\n        throw new Error(response.message || 'Registration failed');\n      }\n    } catch (error) {\n      set({\n        error: error instanceof Error ? error.message : 'Registration failed',\n        isLoading: false,\n      });\n      throw error;\n    }\n  },\n\n  socialLogin: async (provider: 'google' | 'apple', payload: Record<string, unknown>) => {\n    set({ isLoading: true, error: null });\n    try {\n      const response =\n        provider === 'google'\n          ? await authApi.socialLoginGoogle(payload as any)\n          : await authApi.socialLoginApple(payload as any);\n\n      if (response.success) {\n        setAuthToken((response as any).data.token);\n        set({\n          user: (response as any).data.user,\n          token: (response as any).data.token,\n          isAuthenticated: true,\n          isLoading: false,\n        });\n      } else {\n        throw new Error(response.message || 'Social login failed');\n      }\n    } catch (error) {\n      set({\n        error: error instanceof Error ? error.message : 'Social login failed',\n        isLoading: false,\n      });\n      throw error;\n    }\n  },\n\n  logout: async () => {\n    set({ isLoading: true });\n    try {\n      await authApi.logout();\n    } catch {\n      // Continue with logout even if API call fails\n    } finally {\n      setAuthToken(null);\n      set({\n        user: null,\n        token: null,\n        isAuthenticated: false,\n        isLoading: false,\n        error: null,\n      });\n    }\n  },\n\n  loadUser: async () => {\n    const { token } = get();\n    if (!token) {\n      set({ isLoading: false });\n      return;\n    }\n\n    set({ isLoading: true });\n    try {\n      const response = await authApi.getProfile();\n      if (response.success) {\n        set({\n          user: response.data,\n          isAuthenticated: true,\n          isLoading: false,\n        });\n      } else {\n        throw new Error('Failed to load user');\n      }\n    } catch {\n      // Token might be invalid, clear auth state\n      setAuthToken(null);\n      set({\n        user: null,\n        token: null,\n        isAuthenticated: false,\n        isLoading: false,\n      });\n    }\n  },\n\n  updateProfile: async (data: Partial<User>) => {\n    set({ isLoading: true, error: null });\n    try {\n      const { token, user } = get();\n\n      // Demo mode (or offline/dev without backend) should still allow local profile edits.\n      if (token === 'demo-token' && user) {\n        set({\n          user: {\n            ...user,\n            ...data,\n            preferences: data.preferences ?? user.preferences,\n            stats: data.stats ?? user.stats,\n          },\n          isLoading: false,\n        });\n        return;\n      }\n\n      const response = await authApi.updateProfile(data);\n      if (response.success) {\n        set({\n          user: response.data,\n          isLoading: false,\n        });\n      } else {\n        throw new Error(response.message || 'Failed to update profile');\n      }\n    } catch (error) {\n      const { user } = get();\n      if (user) {\n        // Fall back to local merge if the backend isn't reachable.\n        set({\n          user: {\n            ...user,\n            ...data,\n            preferences: data.preferences ?? user.preferences,\n            stats: data.stats ?? user.stats,\n          },\n        });\n      }\n      set({\n        error: error instanceof Error ? error.message : 'Failed to update profile',\n        isLoading: false,\n      });\n      throw error;\n    }\n  },\n\n  clearError: () => set({ error: null }),\n\n  // Demo mode for development/testing\n  setDemoMode: () => {\n    set({\n      user: mockData.user,\n      token: 'demo-token',\n      isAuthenticated: true,\n      isLoading: false,\n      error: null,\n    });\n  },\n}));\n\nexport default useAuthStore;\n"],"mappings":"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","ignoreList":[]}