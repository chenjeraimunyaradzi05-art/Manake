{"version":3,"names":["_reactNative","require","_jestMatcherUtils","_utils","toHaveStyle","element","style","_reactNative$StyleShe","_reactNative$StyleShe2","_this","checkHostElement","expected","StyleSheet","flatten","received","props","pass","Object","keys","every","key","equals","message","to","isNot","matcher","matcherHint","formatMessage","formatStyles","pickReceivedStyles","expectedDiff","join","receivedNarrow","diff","result","forEach","undefined","sort","map","prop","Array","isArray","JSON","stringify"],"sources":["../../src/matchers/to-have-style.tsx"],"sourcesContent":["import type { ReactTestInstance } from 'react-test-renderer';\nimport {\n  ImageStyle,\n  StyleProp,\n  StyleSheet,\n  TextStyle,\n  ViewStyle,\n} from 'react-native';\nimport { matcherHint, diff } from 'jest-matcher-utils';\nimport { checkHostElement, formatMessage } from './utils';\n\nexport type Style = ViewStyle | TextStyle | ImageStyle;\n\ntype StyleLike = Record<string, unknown>;\n\nexport function toHaveStyle(\n  this: jest.MatcherContext,\n  element: ReactTestInstance,\n  style: StyleProp<Style>\n) {\n  checkHostElement(element, toHaveStyle, this);\n\n  const expected = (StyleSheet.flatten(style) as StyleLike) ?? {};\n  const received = (StyleSheet.flatten(element.props.style) as StyleLike) ?? {};\n\n  const pass = Object.keys(expected).every((key) =>\n    this.equals(expected[key], received[key])\n  );\n\n  return {\n    pass,\n    message: () => {\n      const to = this.isNot ? 'not to' : 'to';\n      const matcher = matcherHint(\n        `${this.isNot ? '.not' : ''}.toHaveStyle`,\n        'element',\n        ''\n      );\n\n      if (pass) {\n        return formatMessage(\n          matcher,\n          `Expected element ${to} have style`,\n          formatStyles(expected),\n          'Received',\n          formatStyles(pickReceivedStyles(expected, received))\n        );\n      } else {\n        return [matcher, '', expectedDiff(expected, received)].join('\\n');\n      }\n    },\n  };\n}\n\n/**\n * Generate diff between `expected` and `received` styles.\n */\nfunction expectedDiff(expected: StyleLike, received: StyleLike) {\n  const receivedNarrow = pickReceivedStyles(expected, received);\n  return diff(formatStyles(expected), formatStyles(receivedNarrow));\n}\n\n/**\n * Pick from `received` style only the keys present in `expected` style.\n */\nfunction pickReceivedStyles(expected: StyleLike, received: StyleLike) {\n  const result: StyleLike = {};\n  Object.keys(received).forEach((key) => {\n    if (expected[key] !== undefined) {\n      result[key] = received[key];\n    }\n  });\n\n  return result;\n}\n\nfunction formatStyles(style: StyleLike) {\n  return Object.keys(style)\n    .sort()\n    .map((prop) =>\n      Array.isArray(style[prop])\n        ? `${prop}: ${JSON.stringify(style[prop], null, 2)};`\n        : `${prop}: ${style[prop]};`\n    )\n    .join('\\n');\n}\n"],"mappings":"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","ignoreList":[]}