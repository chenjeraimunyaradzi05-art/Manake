{"version":3,"names":["LocalAuthentication","loadBiometricModule","_loadBiometricModule","apply","arguments","_asyncToGenerator2","default","_imported$default","imported","require","_unused","mapAuthTypeToBiometricType","module","type","AuthenticationType","FINGERPRINT","FACIAL_RECOGNITION","IRIS","getBiometricLabel","biometricType","getBiometricStatus","_getBiometricStatus","mod","isAvailable","isEnrolled","hasHardware","hasHardwareAsync","enrolled","isEnrolledAsync","supportedTypes","supportedAuthenticationTypesAsync","mapped","map","t","find","e","error","Error","message","authenticateBiometric","_x","_authenticateBiometric","options","_result$error","success","result","authenticateAsync","promptMessage","cancelLabel","fallbackLabel","disableDeviceFallback"],"sources":["biometric.ts"],"sourcesContent":["export type BiometricType = 'fingerprint' | 'facial' | 'iris' | 'none';\r\n\r\nexport interface BiometricResult {\r\n  success: boolean;\r\n  error?: string;\r\n  warning?: string;\r\n}\r\n\r\nexport interface BiometricStatus {\r\n  isAvailable: boolean;\r\n  isEnrolled: boolean;\r\n  biometricType: BiometricType;\r\n  error?: string;\r\n}\r\n\r\nexport interface AuthenticateBiometricOptions {\r\n  promptMessage: string;\r\n  cancelLabel: string;\r\n  fallbackLabel: string;\r\n  disableDeviceFallback: boolean;\r\n}\r\n\r\nlet LocalAuthentication: any = null;\r\n\r\ndeclare const require: any;\r\n\r\nasync function loadBiometricModule() {\r\n  if (LocalAuthentication) return LocalAuthentication;\r\n  try {\r\n    const imported = require('expo-local-authentication');\r\n    LocalAuthentication = imported?.default ?? imported;\r\n  } catch {\r\n    LocalAuthentication = null;\r\n  }\r\n  return LocalAuthentication;\r\n}\r\n\r\nfunction mapAuthTypeToBiometricType(module: any, type: number): BiometricType {\r\n  if (!module?.AuthenticationType) return 'none';\r\n  if (type === module.AuthenticationType.FINGERPRINT) return 'fingerprint';\r\n  if (type === module.AuthenticationType.FACIAL_RECOGNITION) return 'facial';\r\n  if (type === module.AuthenticationType.IRIS) return 'iris';\r\n  return 'none';\r\n}\r\n\r\nexport function getBiometricLabel(biometricType: BiometricType): string {\r\n  if (biometricType === 'facial') return 'Face ID';\r\n  if (biometricType === 'fingerprint') return 'Fingerprint';\r\n  if (biometricType === 'iris') return 'Iris';\r\n  return 'Biometrics';\r\n}\r\n\r\nexport async function getBiometricStatus(): Promise<BiometricStatus> {\r\n  try {\r\n    const mod = await loadBiometricModule();\r\n    if (!mod) {\r\n      return { isAvailable: false, isEnrolled: false, biometricType: 'none' };\r\n    }\r\n\r\n    const hasHardware = await mod.hasHardwareAsync();\r\n    if (!hasHardware) {\r\n      return { isAvailable: false, isEnrolled: false, biometricType: 'none' };\r\n    }\r\n\r\n    const enrolled = await mod.isEnrolledAsync();\r\n    if (!enrolled) {\r\n      return { isAvailable: false, isEnrolled: false, biometricType: 'none' };\r\n    }\r\n\r\n    const supportedTypes: number[] = await mod.supportedAuthenticationTypesAsync();\r\n    const mapped = supportedTypes\r\n      .map((t) => mapAuthTypeToBiometricType(mod, t))\r\n      .find((t) => t !== 'none');\r\n\r\n    return {\r\n      isAvailable: true,\r\n      isEnrolled: true,\r\n      biometricType: mapped ?? 'none',\r\n    };\r\n  } catch (e) {\r\n    return {\r\n      isAvailable: false,\r\n      isEnrolled: false,\r\n      biometricType: 'none',\r\n      error: e instanceof Error ? e.message : 'Failed to check biometrics',\r\n    };\r\n  }\r\n}\r\n\r\nexport async function authenticateBiometric(\r\n  options: AuthenticateBiometricOptions\r\n): Promise<BiometricResult> {\r\n  try {\r\n    const mod = await loadBiometricModule();\r\n    if (!mod) {\r\n      return { success: false, error: 'Biometrics not available' };\r\n    }\r\n\r\n    const result = await mod.authenticateAsync({\r\n      promptMessage: options.promptMessage,\r\n      cancelLabel: options.cancelLabel,\r\n      fallbackLabel: options.fallbackLabel,\r\n      disableDeviceFallback: options.disableDeviceFallback,\r\n    });\r\n\r\n    if (result?.success) return { success: true };\r\n\r\n    return {\r\n      success: false,\r\n      error: result?.error ?? 'Authentication cancelled',\r\n    };\r\n  } catch (e) {\r\n    return {\r\n      success: false,\r\n      error: e instanceof Error ? e.message : 'Authentication failed',\r\n    };\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}