{"version":3,"names":["_reactNative","require","_api","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty2","default","getOwnPropertyDescriptors","defineProperties","defineProperty","API_BASE_URL","__DEV__","Platform","select","ios","android","fetchApi","_x","_fetchApi","_asyncToGenerator2","endpoint","options","undefined","url","token","getAuthToken","headers","response","fetch","ok","errorData","json","catch","Error","message","status","getDashboardStats","exports","_ref","getRecentActivity","_ref2","limit","getPendingStories","_ref3","page","approveStory","_ref4","storyId","method","_x2","rejectStory","_ref5","reason","body","JSON","stringify","_x3","_x4","toggleFeatureStory","_ref6","featured","_x5","_x6","deleteStory","_ref7","_x7","getUsers","_ref8","params","URLSearchParams","String","role","append","search","getUserById","_ref9","userId","_x8","updateUserRole","_ref0","_x9","_x0","toggleUserActive","_ref1","_x1","deleteUser","_ref10","_x10"],"sources":["admin.ts"],"sourcesContent":["/**\r\n * Admin Service\r\n * Handles admin dashboard API calls for moderation and analytics\r\n */\r\n\r\nimport { Platform } from 'react-native';\r\nimport { getAuthToken } from './api';\r\n\r\n// API Configuration\r\nconst API_BASE_URL = __DEV__ \r\n  ? Platform.select({\r\n      ios: 'http://localhost:3001/api',\r\n      android: 'http://10.0.2.2:3001/api',\r\n      default: 'http://localhost:3001/api'\r\n    })\r\n  : 'https://manake.netlify.app/api';\r\n\r\n// Generic fetch wrapper\r\nasync function fetchApi<T>(endpoint: string, options: RequestInit = {}): Promise<T> {\r\n  const url = `${API_BASE_URL}${endpoint}`;\r\n  const token = getAuthToken();\r\n  \r\n  const headers: HeadersInit = {\r\n    'Content-Type': 'application/json',\r\n    ...options.headers,\r\n  };\r\n  \r\n  if (token) {\r\n    (headers as Record<string, string>)['Authorization'] = `Bearer ${token}`;\r\n  }\r\n\r\n  const response = await fetch(url, { ...options, headers });\r\n\r\n  if (!response.ok) {\r\n    const errorData = await response.json().catch(() => ({}));\r\n    throw new Error(errorData.message || `HTTP error! status: ${response.status}`);\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n// ============ Types ============\r\n\r\nexport interface DashboardStats {\r\n  users: {\r\n    total: number;\r\n    newThisMonth: number;\r\n  };\r\n  stories: {\r\n    total: number;\r\n    pending: number;\r\n  };\r\n  donations: {\r\n    totalAmount: number;\r\n    totalCount: number;\r\n    thisMonth: { amount: number; count: number };\r\n    lastMonth: { amount: number; count: number };\r\n  };\r\n  messages: {\r\n    total: number;\r\n    unread: number;\r\n  };\r\n}\r\n\r\nexport interface AdminStory {\r\n  _id: string;\r\n  title: string;\r\n  excerpt: string;\r\n  author: { name: string; role: string };\r\n  category: string;\r\n  status: 'draft' | 'pending' | 'published' | 'rejected';\r\n  featured: boolean;\r\n  createdAt: string;\r\n  publishedAt?: string;\r\n}\r\n\r\nexport interface AdminUser {\r\n  _id: string;\r\n  name: string;\r\n  email: string;\r\n  role: 'user' | 'admin' | 'moderator';\r\n  isActive: boolean;\r\n  isEmailVerified: boolean;\r\n  createdAt: string;\r\n  lastLogin?: string;\r\n}\r\n\r\nexport interface PaginatedResponse<T> {\r\n  data: T[];\r\n  pagination: {\r\n    page: number;\r\n    limit: number;\r\n    total: number;\r\n    pages: number;\r\n  };\r\n}\r\n\r\n// ============ Dashboard ============\r\n\r\nexport const getDashboardStats = async (): Promise<DashboardStats> => {\r\n  return fetchApi<DashboardStats>('/v1/admin/stats');\r\n};\r\n\r\nexport const getRecentActivity = async (limit = 20) => {\r\n  return fetchApi(`/v1/admin/activity?limit=${limit}`);\r\n};\r\n\r\n// ============ Story Moderation ============\r\n\r\nexport const getPendingStories = async (page = 1, limit = 20): Promise<PaginatedResponse<AdminStory>> => {\r\n  return fetchApi<PaginatedResponse<AdminStory>>(`/v1/admin/stories/pending?page=${page}&limit=${limit}`);\r\n};\r\n\r\nexport const approveStory = async (storyId: string): Promise<{ message: string; data: AdminStory }> => {\r\n  return fetchApi<{ message: string; data: AdminStory }>(`/v1/admin/stories/${storyId}/approve`, {\r\n    method: 'PATCH',\r\n  });\r\n};\r\n\r\nexport const rejectStory = async (storyId: string, reason?: string): Promise<{ message: string; data: AdminStory }> => {\r\n  return fetchApi<{ message: string; data: AdminStory }>(`/v1/admin/stories/${storyId}/reject`, {\r\n    method: 'PATCH',\r\n    body: JSON.stringify({ reason }),\r\n  });\r\n};\r\n\r\nexport const toggleFeatureStory = async (storyId: string, featured: boolean): Promise<{ message: string; data: AdminStory }> => {\r\n  return fetchApi<{ message: string; data: AdminStory }>(`/v1/admin/stories/${storyId}/feature`, {\r\n    method: 'PATCH',\r\n    body: JSON.stringify({ featured }),\r\n  });\r\n};\r\n\r\nexport const deleteStory = async (storyId: string): Promise<{ message: string }> => {\r\n  return fetchApi<{ message: string }>(`/v1/admin/stories/${storyId}`, {\r\n    method: 'DELETE',\r\n  });\r\n};\r\n\r\n// ============ User Management ============\r\n\r\nexport const getUsers = async (\r\n  page = 1,\r\n  limit = 20,\r\n  options?: { role?: string; search?: string }\r\n): Promise<PaginatedResponse<AdminUser>> => {\r\n  const params = new URLSearchParams({ page: String(page), limit: String(limit) });\r\n  if (options?.role) params.append('role', options.role);\r\n  if (options?.search) params.append('search', options.search);\r\n  \r\n  return fetchApi<PaginatedResponse<AdminUser>>(`/v1/admin/users?${params}`);\r\n};\r\n\r\nexport const getUserById = async (userId: string): Promise<{ data: AdminUser }> => {\r\n  return fetchApi<{ data: AdminUser }>(`/v1/admin/users/${userId}`);\r\n};\r\n\r\nexport const updateUserRole = async (\r\n  userId: string,\r\n  role: 'user' | 'admin' | 'moderator'\r\n): Promise<{ message: string; data: AdminUser }> => {\r\n  return fetchApi<{ message: string; data: AdminUser }>(`/v1/admin/users/${userId}/role`, {\r\n    method: 'PATCH',\r\n    body: JSON.stringify({ role }),\r\n  });\r\n};\r\n\r\nexport const toggleUserActive = async (userId: string): Promise<{ message: string; data: { id: string; isActive: boolean } }> => {\r\n  return fetchApi<{ message: string; data: { id: string; isActive: boolean } }>(`/v1/admin/users/${userId}/toggle-active`, {\r\n    method: 'PATCH',\r\n  });\r\n};\r\n\r\nexport const deleteUser = async (userId: string): Promise<{ message: string }> => {\r\n  return fetchApi<{ message: string }>(`/v1/admin/users/${userId}`, {\r\n    method: 'DELETE',\r\n  });\r\n};\r\n"],"mappings":"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","ignoreList":[]}