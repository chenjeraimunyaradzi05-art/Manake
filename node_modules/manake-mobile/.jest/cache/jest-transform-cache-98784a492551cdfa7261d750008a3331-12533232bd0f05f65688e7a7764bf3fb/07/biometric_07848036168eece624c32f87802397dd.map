{"version":3,"names":["LocalAuthentication","cov_1cle8lvcj1","s","loadBiometricModule","_loadBiometricModule","apply","arguments","_asyncToGenerator2","default","f","b","_ref","imported","_unused","mapAuthTypeToBiometricType","module","type","AuthenticationType","FINGERPRINT","FACIAL_RECOGNITION","IRIS","getBiometricLabel","biometricType","getBiometricStatus","_getBiometricStatus","_ref2","mod","isAvailable","isEnrolled","hasHardware","hasHardwareAsync","enrolled","isEnrolledAsync","supportedTypes","supportedAuthenticationTypesAsync","mapped","map","t","find","e","error","Error","message","authenticateBiometric","_x","_authenticateBiometric","options","_ref3","success","result","authenticateAsync","promptMessage","cancelLabel","fallbackLabel","disableDeviceFallback"],"sources":["biometric.ts"],"sourcesContent":["export type BiometricType = 'fingerprint' | 'facial' | 'iris' | 'none';\r\n\r\nexport interface BiometricResult {\r\n  success: boolean;\r\n  error?: string;\r\n  warning?: string;\r\n}\r\n\r\nexport interface BiometricStatus {\r\n  isAvailable: boolean;\r\n  isEnrolled: boolean;\r\n  biometricType: BiometricType;\r\n  error?: string;\r\n}\r\n\r\nexport interface AuthenticateBiometricOptions {\r\n  promptMessage: string;\r\n  cancelLabel: string;\r\n  fallbackLabel: string;\r\n  disableDeviceFallback: boolean;\r\n}\r\n\r\nlet LocalAuthentication: any = null;\r\n\r\nasync function loadBiometricModule() {\r\n  if (LocalAuthentication) return LocalAuthentication;\r\n  try {\r\n    const imported = await import('expo-local-authentication');\r\n    LocalAuthentication = (imported as any)?.default ?? imported;\r\n  } catch {\r\n    LocalAuthentication = null;\r\n  }\r\n  return LocalAuthentication;\r\n}\r\n\r\nfunction mapAuthTypeToBiometricType(module: any, type: number): BiometricType {\r\n  if (!module?.AuthenticationType) return 'none';\r\n  if (type === module.AuthenticationType.FINGERPRINT) return 'fingerprint';\r\n  if (type === module.AuthenticationType.FACIAL_RECOGNITION) return 'facial';\r\n  if (type === module.AuthenticationType.IRIS) return 'iris';\r\n  return 'none';\r\n}\r\n\r\nexport function getBiometricLabel(biometricType: BiometricType): string {\r\n  if (biometricType === 'facial') return 'Face ID';\r\n  if (biometricType === 'fingerprint') return 'Fingerprint';\r\n  if (biometricType === 'iris') return 'Iris';\r\n  return 'Biometrics';\r\n}\r\n\r\nexport async function getBiometricStatus(): Promise<BiometricStatus> {\r\n  try {\r\n    const mod = await loadBiometricModule();\r\n    if (!mod) {\r\n      return { isAvailable: false, isEnrolled: false, biometricType: 'none' };\r\n    }\r\n\r\n    const hasHardware = await mod.hasHardwareAsync();\r\n    if (!hasHardware) {\r\n      return { isAvailable: false, isEnrolled: false, biometricType: 'none' };\r\n    }\r\n\r\n    const enrolled = await mod.isEnrolledAsync();\r\n    if (!enrolled) {\r\n      return { isAvailable: false, isEnrolled: false, biometricType: 'none' };\r\n    }\r\n\r\n    const supportedTypes: number[] = await mod.supportedAuthenticationTypesAsync();\r\n    const mapped = supportedTypes\r\n      .map((t) => mapAuthTypeToBiometricType(mod, t))\r\n      .find((t) => t !== 'none');\r\n\r\n    return {\r\n      isAvailable: true,\r\n      isEnrolled: true,\r\n      biometricType: mapped ?? 'none',\r\n    };\r\n  } catch (e) {\r\n    return {\r\n      isAvailable: false,\r\n      isEnrolled: false,\r\n      biometricType: 'none',\r\n      error: e instanceof Error ? e.message : 'Failed to check biometrics',\r\n    };\r\n  }\r\n}\r\n\r\nexport async function authenticateBiometric(\r\n  options: AuthenticateBiometricOptions\r\n): Promise<BiometricResult> {\r\n  try {\r\n    const mod = await loadBiometricModule();\r\n    if (!mod) {\r\n      return { success: false, error: 'Biometrics not available' };\r\n    }\r\n\r\n    const result = await mod.authenticateAsync({\r\n      promptMessage: options.promptMessage,\r\n      cancelLabel: options.cancelLabel,\r\n      fallbackLabel: options.fallbackLabel,\r\n      disableDeviceFallback: options.disableDeviceFallback,\r\n    });\r\n\r\n    if (result?.success) return { success: true };\r\n\r\n    return {\r\n      success: false,\r\n      error: result?.error ?? 'Authentication cancelled',\r\n    };\r\n  } catch (e) {\r\n    return {\r\n      success: false,\r\n      error: e instanceof Error ? e.message : 'Authentication failed',\r\n    };\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}