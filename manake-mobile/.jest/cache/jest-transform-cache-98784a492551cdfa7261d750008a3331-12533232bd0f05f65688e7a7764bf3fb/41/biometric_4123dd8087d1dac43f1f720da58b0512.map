{"version":3,"names":["LocalAuthentication","cov_1cle8lvcj1","s","loadBiometricModule","_loadBiometricModule","apply","arguments","_asyncToGenerator2","default","f","b","_ref","imported","require","_unused","mapAuthTypeToBiometricType","module","type","AuthenticationType","FINGERPRINT","FACIAL_RECOGNITION","IRIS","getBiometricLabel","biometricType","getBiometricStatus","_getBiometricStatus","_ref2","mod","isAvailable","isEnrolled","hasHardware","hasHardwareAsync","enrolled","isEnrolledAsync","supportedTypes","supportedAuthenticationTypesAsync","mapped","map","t","find","e","error","Error","message","authenticateBiometric","_x","_authenticateBiometric","options","_ref3","success","result","authenticateAsync","promptMessage","cancelLabel","fallbackLabel","disableDeviceFallback"],"sources":["biometric.ts"],"sourcesContent":["export type BiometricType = 'fingerprint' | 'facial' | 'iris' | 'none';\r\n\r\nexport interface BiometricResult {\r\n  success: boolean;\r\n  error?: string;\r\n  warning?: string;\r\n}\r\n\r\nexport interface BiometricStatus {\r\n  isAvailable: boolean;\r\n  isEnrolled: boolean;\r\n  biometricType: BiometricType;\r\n  error?: string;\r\n}\r\n\r\nexport interface AuthenticateBiometricOptions {\r\n  promptMessage: string;\r\n  cancelLabel: string;\r\n  fallbackLabel: string;\r\n  disableDeviceFallback: boolean;\r\n}\r\n\r\nlet LocalAuthentication: any = null;\r\n\r\ndeclare const require: any;\r\n\r\nasync function loadBiometricModule() {\r\n  if (LocalAuthentication) return LocalAuthentication;\r\n  try {\r\n    const imported = require('expo-local-authentication');\r\n    LocalAuthentication = imported?.default ?? imported;\r\n  } catch {\r\n    LocalAuthentication = null;\r\n  }\r\n  return LocalAuthentication;\r\n}\r\n\r\nfunction mapAuthTypeToBiometricType(module: any, type: number): BiometricType {\r\n  if (!module?.AuthenticationType) return 'none';\r\n  if (type === module.AuthenticationType.FINGERPRINT) return 'fingerprint';\r\n  if (type === module.AuthenticationType.FACIAL_RECOGNITION) return 'facial';\r\n  if (type === module.AuthenticationType.IRIS) return 'iris';\r\n  return 'none';\r\n}\r\n\r\nexport function getBiometricLabel(biometricType: BiometricType): string {\r\n  if (biometricType === 'facial') return 'Face ID';\r\n  if (biometricType === 'fingerprint') return 'Fingerprint';\r\n  if (biometricType === 'iris') return 'Iris';\r\n  return 'Biometrics';\r\n}\r\n\r\nexport async function getBiometricStatus(): Promise<BiometricStatus> {\r\n  try {\r\n    const mod = await loadBiometricModule();\r\n    if (!mod) {\r\n      return { isAvailable: false, isEnrolled: false, biometricType: 'none' };\r\n    }\r\n\r\n    const hasHardware = await mod.hasHardwareAsync();\r\n    if (!hasHardware) {\r\n      return { isAvailable: false, isEnrolled: false, biometricType: 'none' };\r\n    }\r\n\r\n    const enrolled = await mod.isEnrolledAsync();\r\n    if (!enrolled) {\r\n      return { isAvailable: false, isEnrolled: false, biometricType: 'none' };\r\n    }\r\n\r\n    const supportedTypes: number[] = await mod.supportedAuthenticationTypesAsync();\r\n    const mapped = supportedTypes\r\n      .map((t) => mapAuthTypeToBiometricType(mod, t))\r\n      .find((t) => t !== 'none');\r\n\r\n    return {\r\n      isAvailable: true,\r\n      isEnrolled: true,\r\n      biometricType: mapped ?? 'none',\r\n    };\r\n  } catch (e) {\r\n    return {\r\n      isAvailable: false,\r\n      isEnrolled: false,\r\n      biometricType: 'none',\r\n      error: e instanceof Error ? e.message : 'Failed to check biometrics',\r\n    };\r\n  }\r\n}\r\n\r\nexport async function authenticateBiometric(\r\n  options: AuthenticateBiometricOptions\r\n): Promise<BiometricResult> {\r\n  try {\r\n    const mod = await loadBiometricModule();\r\n    if (!mod) {\r\n      return { success: false, error: 'Biometrics not available' };\r\n    }\r\n\r\n    const result = await mod.authenticateAsync({\r\n      promptMessage: options.promptMessage,\r\n      cancelLabel: options.cancelLabel,\r\n      fallbackLabel: options.fallbackLabel,\r\n      disableDeviceFallback: options.disableDeviceFallback,\r\n    });\r\n\r\n    if (result?.success) return { success: true };\r\n\r\n    return {\r\n      success: false,\r\n      error: result?.error ?? 'Authentication cancelled',\r\n    };\r\n  } catch (e) {\r\n    return {\r\n      success: false,\r\n      error: e instanceof Error ? e.message : 'Authentication failed',\r\n    };\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}