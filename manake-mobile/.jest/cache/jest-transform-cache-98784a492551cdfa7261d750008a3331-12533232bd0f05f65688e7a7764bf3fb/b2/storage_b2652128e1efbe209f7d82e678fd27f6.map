{"version":3,"names":["SecureStore","_interopRequireWildcard","require","_reactNative","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","STORAGE_KEYS","exports","AUTH_TOKEN","USER_DATA","PREFERENCES","ONBOARDING_COMPLETE","SecureStorageService","_classCallCheck2","webStorage","Map","_createClass2","key","value","_setItem","_asyncToGenerator2","Platform","OS","localStorage","setItem","setItemAsync","error","console","_x","_x2","apply","arguments","_getItem","getItem","getItemAsync","_x3","_deleteItem","delete","removeItem","deleteItemAsync","deleteItem","_x4","_setObject","jsonValue","JSON","stringify","setObject","_x5","_x6","_getObject","parse","_unused","process","env","NODE_ENV","getObject","_x7","_clearAll","_this","keys","values","Promise","all","map","clearAll","secureStorage","_default"],"sources":["storage.ts"],"sourcesContent":["import * as SecureStore from 'expo-secure-store';\r\nimport { Platform } from 'react-native';\r\n\r\n// Keys for secure storage\r\nexport const STORAGE_KEYS = {\r\n  AUTH_TOKEN: 'manake_auth_token',\r\n  USER_DATA: 'manake_user_data',\r\n  PREFERENCES: 'manake_preferences',\r\n  ONBOARDING_COMPLETE: 'manake_onboarding_complete',\r\n} as const;\r\n\r\ntype StorageKey = (typeof STORAGE_KEYS)[keyof typeof STORAGE_KEYS];\r\n\r\n/**\r\n * Secure Storage Service\r\n * Uses expo-secure-store for native platforms and falls back to in-memory storage for web\r\n */\r\nclass SecureStorageService {\r\n  private webStorage: Map<string, string> = new Map();\r\n\r\n  /**\r\n   * Store a value securely\r\n   */\r\n  async setItem(key: StorageKey, value: string): Promise<void> {\r\n    try {\r\n      if (Platform.OS === 'web') {\r\n        // Web fallback - use localStorage (less secure but functional)\r\n        this.webStorage.set(key, value);\r\n        if (typeof localStorage !== 'undefined') {\r\n          localStorage.setItem(key, value);\r\n        }\r\n      } else {\r\n        await SecureStore.setItemAsync(key, value);\r\n      }\r\n    } catch (error) {\r\n      console.error(`Failed to store ${key}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Retrieve a value from secure storage\r\n   */\r\n  async getItem(key: StorageKey): Promise<string | null> {\r\n    try {\r\n      if (Platform.OS === 'web') {\r\n        // Web fallback\r\n        if (typeof localStorage !== 'undefined') {\r\n          return localStorage.getItem(key);\r\n        }\r\n        return this.webStorage.get(key) || null;\r\n      }\r\n      return await SecureStore.getItemAsync(key);\r\n    } catch (error) {\r\n      console.error(`Failed to retrieve ${key}:`, error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete a value from secure storage\r\n   */\r\n  async deleteItem(key: StorageKey): Promise<void> {\r\n    try {\r\n      if (Platform.OS === 'web') {\r\n        this.webStorage.delete(key);\r\n        if (typeof localStorage !== 'undefined') {\r\n          localStorage.removeItem(key);\r\n        }\r\n      } else {\r\n        await SecureStore.deleteItemAsync(key);\r\n      }\r\n    } catch (error) {\r\n      console.error(`Failed to delete ${key}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Store an object as JSON\r\n   */\r\n  async setObject<T>(key: StorageKey, value: T): Promise<void> {\r\n    const jsonValue = JSON.stringify(value);\r\n    await this.setItem(key, jsonValue);\r\n  }\r\n\r\n  /**\r\n   * Retrieve and parse a JSON object\r\n   */\r\n  async getObject<T>(key: StorageKey): Promise<T | null> {\r\n    const jsonValue = await this.getItem(key);\r\n    if (!jsonValue) return null;\r\n    try {\r\n      return JSON.parse(jsonValue) as T;\r\n    } catch {\r\n      if (process.env.NODE_ENV !== 'test') {\r\n        console.error(`Failed to parse ${key} as JSON`);\r\n      }\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all stored data (useful for logout)\r\n   */\r\n  async clearAll(): Promise<void> {\r\n    const keys = Object.values(STORAGE_KEYS);\r\n    await Promise.all(keys.map((key) => this.deleteItem(key)));\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const secureStorage = new SecureStorageService();\r\n\r\nexport default secureStorage;\r\n"],"mappings":"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","ignoreList":[]}